<div id="modal-overlay" class="fixed top-0 left-0 w-full h-full bg-black/30 flex justify-center items-center" >
<div id="modal-content" class="bg-white p-5 w-120 h-70 rounded-[15px]">
  <div>
    <h2 class="text-lg m-0 mt-[5px] pb-5" >New Trip</h2>
    <form onsubmit="handleSaveTrip(event)" style="display: inline">
      <input type="hidden" name="_method" id="trip_method" value="POST">
      <div class="h-40">
        <div>
          <label for="title">Title</label><br>
          <input id="trip_title" type="text" name="title" title="Title"  class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 placeholder-gray-400 focus:outline-none focus:border-indigo-500 focus:ring focus:ring-indigo-500 shadow-sm" placeholder="Enter your title here">
        </div> 
        <div class="mt-3">
          <label for="date">Date</label><br>
          <input id="trip_date" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 placeholder-gray-400 focus:outline-none focus:border-indigo-500 focus:ring focus:ring-indigo-500 shadow-sm" type="date" name="date" title="Date" />
        </div> 
      </div> 
      <div class="text-right">
        <button onclick="document.getElementById('modal_create_trip').classList.add('hidden');" class="bg-[#9fcee9] rounded-[5px] text-blue-900 border-none h-7 w-20 text-sm cursor-pointer" type="button" >Cancel</button>
        <button class="bg-[#9fcee9] rounded-[5px] text-blue-900 border-none h-7 w-20 text-sm cursor-pointer" type="submit">Save</button>
      </div> 
    </form>
    </div>
  </div>
</div>

<script>
  function handleSaveTrip(event) {
    event.preventDefault();
    const modal = document.getElementById('modal_create_trip');
    const tripId = modal.dataset.id;
    const title = document.getElementById('trip_title').value;
    const date = document.getElementById('trip_date').value;
    const method = tripId ? 'PUT' : 'POST';
    const url = tripId ? `/trips/${tripId}` : '/trips';
    fetch(url, {
      method: method,
      headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
      },
      body: JSON.stringify({ title: title, date: date })
    })
    .then(response => {
      if (response.ok) {
        window.location.reload();
      } else {
        alert('Could not save trip');
      }
    })
    .catch(error => {
      console.log(error, 'error');
    });
  }
</script>